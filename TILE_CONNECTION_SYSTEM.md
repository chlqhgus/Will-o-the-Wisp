# 타일 연결 시스템 설명

## 작동 원리

네모 타일이 회전해도 연결 상태를 정확히 판단할 수 있습니다. 각 타일은 **4방향(상, 우, 하, 좌)의 연결 상태**를 내부적으로 관리합니다.

### 1. 타일 타입별 연결 패턴

- **Straight (직선)**: 
  - rotation % 2 == 0: 상하 연결
  - rotation % 2 == 1: 좌우 연결

- **Corner (코너)**: 
  - rotation 0: 상우 연결
  - rotation 1: 우하 연결
  - rotation 2: 하좌 연결
  - rotation 3: 좌상 연결

- **DeadEnd (막힌 길)**: 
  - rotation에 따라 한 방향만 연결

- **Start/Clear/Lose**: 
  - 모든 방향 연결 (목표 지점이므로)

### 2. 연결 확인 로직

두 타일이 연결되려면:
1. **타일 A**가 특정 방향(예: 우)으로 연결되어 있어야 함
2. **타일 B**가 반대 방향(예: 좌)으로 연결되어 있어야 함
3. 두 조건이 모두 만족되어야 이동 가능

### 3. 캐릭터 이동 로직

`HumanController`는 다음 순서로 경로를 찾습니다:
1. 현재 타일의 연결 방향 확인
2. 각 방향으로 인접 타일 확인
3. 인접 타일이 반대 방향으로 연결되어 있는지 확인
4. 연결되어 있으면 이동 가능
5. 이전에 온 방향은 제외 (되돌아가지 않음)

## 시각화 기능

### 디버그 모드 활성화

Unity 에디터에서:
1. 타일 오브젝트 선택
2. Inspector에서 `Show Connections` 체크
3. Scene 뷰에서 타일의 연결 방향이 초록색 선으로 표시됨

### 연결 상태 확인

- 초록색 선: 해당 방향으로 연결됨
- 선 없음: 해당 방향으로 연결되지 않음

## 예시

### 예시 1: 직선 타일 연결
```
[Straight] → [Straight]
  우 연결      좌 연결
```
- 왼쪽 타일: rotation 1 (좌우 연결)
- 오른쪽 타일: rotation 1 (좌우 연결)
- 결과: 연결됨 ✅

### 예시 2: 코너 타일 연결
```
[Corner] → [Straight]
  우 연결    좌 연결
```
- 왼쪽 타일: rotation 0 (상우 연결)
- 오른쪽 타일: rotation 1 (좌우 연결)
- 결과: 연결됨 ✅

### 예시 3: 연결 안 됨
```
[Straight] → [Straight]
  상하 연결    상하 연결
```
- 왼쪽 타일: rotation 0 (상하 연결)
- 오른쪽 타일: rotation 0 (상하 연결)
- 결과: 연결 안 됨 ❌ (좌우 방향이 연결되지 않음)

## 테스트 방법

1. 게임 실행
2. 타일을 회전시켜 경로 만들기
3. START 버튼 클릭
4. 캐릭터가 연결된 타일만 따라 이동하는지 확인

## 문제 해결

### 캐릭터가 이동하지 않는 경우
- 타일이 올바르게 연결되어 있는지 확인
- Show Connections로 연결 상태 확인
- 타일 회전이 제대로 적용되었는지 확인

### 캐릭터가 잘못된 경로로 이동하는 경우
- 타일 연결 방향 확인
- 타일 회전 값 확인 (0-3)
- UpdateConnections()가 제대로 호출되었는지 확인

